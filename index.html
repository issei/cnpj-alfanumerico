<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Validador de CNPJ Alfanumérico</title>
  <style>
    input {
      font-size: 1.2rem;
      padding: 8px;
      width: 280px;
    }
    .valido { border: 2px solid green; }
    .invalido { border: 2px solid red; }
  </style>
</head>
<body>

  <h2>Digite seu CNPJ:</h2>
  <input type="text" id="cnpj" maxlength="18" placeholder="00.000.000/0000-00" />

  <script type="module">
    import CNPJ from './cnpj.js';

    const input = document.getElementById('cnpj');

    // Remover caracteres de máscara
    function limparMascara(valor) {
      return valor.replace(/[^\w\d]/gi, '').toUpperCase(); // mantém letras e dígitos
    }

    // Aplicar a máscara do CNPJ (XX.XXX.XXX/XXXX-XX)
    function aplicarMascara(valor) {
      const v = limparMascara(valor).substring(0, 14); // limita a 14 caracteres
      let result = '';
      for (let i = 0; i < v.length; i++) {
        result += v[i];
        if (i === 1 || i === 4) result += '.';
        if (i === 7) result += '/';
        if (i === 11) result += '-';
      }
      return result;
    }

    input.addEventListener('input', (e) => {
      const cursor = input.selectionStart;
      const raw = limparMascara(e.target.value);
      const comMascara = aplicarMascara(raw);
      input.value = comMascara;
    });

    input.addEventListener('blur', () => {
      const valor = input.value;
      const valido = CNPJ.isValid(valor);
      input.classList.remove('valido', 'invalido');
      input.classList.add(valido ? 'valido' : 'invalido');
    });
  </script>

</body>
</html>
